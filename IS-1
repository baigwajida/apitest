1.
api_data.sql

CREATE TABLE api_data(
Key varchar(15) PRIMARY KEY,
Place_name text,
Admin_name1 text,
Latitude double precision,
Longitude double precision,
Accuracy integer)


Q1.py

from flask import Flask
import csv
import dbapi
conn = dbapi.connect("host=localhost dbname=postgres user=postgres")
cur = conn.cursor()
with open(' https://github.com/sanand0/pincode/blob/master/data/IN.csv', 'r') as f:
reader = csv.reader(f)
next(reader)

app = Flask(__name__)
app.config["DEBUG"] = True

@app.route(“/”, methods=[“GET”,”POST”])
def home():
   error=’’
   try:
	if request.method ==”POST”:
	    lat = request.form[‘latitude’]
	   lng = request.form[‘longitude’]
	else:
	      cur.execute('SELECT * FROM api_data')
	      all = cur.fetchall()
	      for row in reader:
	              cur.execute(
			"INSERT INTO users VALUES (%s, %s, %s, %f, %f, %d)",
		row
	    )
    conn.commit()
    return "Hello World!"
